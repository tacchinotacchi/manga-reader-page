import"../chunks/CWj6FrbW.js";import{x as b,j as K,k as F,X as ue,Y as fe,w as me,aE as ge,g as pe,v as ve,e as X,h as Y,z as he,a0 as _e,$ as ke,ar as be,p as ae,t as B,a as ne,c as w,s as T,E as $e,r as C,f as D,F as t,aF as A,I as q,a7 as ye,J as $}from"../chunks/B9NWKDUK.js";import{c as we,o as Ce,p as xe,a as x,q as G,d as Ee,t as V}from"../chunks/B3d5NtUf.js";import{i as Pe}from"../chunks/DOAcvDwK.js";import{e as se,b as Q,i as Le,a as Z}from"../chunks/FSSEZNyT.js";import{a as Ne,s as Ue}from"../chunks/B0kCNSg1.js";import{p as ee}from"../chunks/BkiW5R2q.js";import{m as Se,g as je,a as Ie,c as Re,e as ze}from"../chunks/Byps_cyz.js";import{o as Ae}from"../chunks/6OZKxOy3.js";import{a as te}from"../chunks/yxu8k9xJ.js";import{i as Te}from"../chunks/BLUEuTwA.js";import{s as H}from"../chunks/CUndlL2M.js";import{l as M,p as N,s as oe}from"../chunks/BJYlG9Yz.js";function Be(g,s,p,v,o,n){let a=b;b&&K();var c,h,r=null;b&&F.nodeType===1&&(r=F,K());var E=b?F:g,l;ue(()=>{const d=s()||null;var _=ge;d!==c&&(l&&(d===null?_e(l,()=>{l=null,h=null}):d===h?ke(l):be(l)),d&&d!==h&&(l=me(()=>{if(r=b?r:document.createElementNS(_,d),we(r,r),v){b&&Ce(d)&&r.append(document.createComment(""));var k=b?pe(r):r.appendChild(ve());b&&(k===null?X(!1):Y(k)),v(r,k)}he.nodes_end=r,E.before(r)})),c=d,c&&(h=c))},fe),a&&(X(!0),Y(E))}/**
 * @license lucide-svelte v0.474.0 - ISC
 *
 * ISC License
 * 
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 * 
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 * 
 */const Me={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};var We=xe("<svg><!><!></svg>");function re(g,s){const p=M(s,["children","$$slots","$$events","$$legacy"]),v=M(p,["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"]);ae(s,!1);let o=N(s,"name",8,void 0),n=N(s,"color",8,"currentColor"),a=N(s,"size",8,24),c=N(s,"strokeWidth",8,2),h=N(s,"absoluteStrokeWidth",8,!1),r=N(s,"iconNode",24,()=>[]);const E=(...u)=>u.filter((m,P,L)=>!!m&&L.indexOf(m)===P).join(" ");Te();var l=We();let d;var _=w(l);se(_,1,r,Le,(u,m)=>{let P=()=>t(m)[0],L=()=>t(m)[1];var I=G(),U=D(I);Be(U,P,!0,(R,S)=>{let z;B(()=>z=Q(R,z,{...L()}))}),x(u,I)});var k=T(_);H(k,s,"default",{}),C(l),B((u,m)=>d=Q(l,d,{...Me,...v,width:a(),height:a(),stroke:n(),"stroke-width":u,class:m}),[()=>h()?Number(c())*24/Number(a()):c(),()=>E("lucide-icon","lucide",o()?`lucide-${o()}`:"",p.class)],$e),x(g,l),ne()}function Oe(g,s){const p=M(s,["children","$$slots","$$events","$$legacy"]);re(g,oe({name:"chevron-left"},()=>p,{iconNode:[["path",{d:"m15 18-6-6 6-6"}]],children:(o,n)=>{var a=G(),c=D(a);H(c,s,"default",{}),x(o,a)},$$slots:{default:!0}}))}function Fe(g,s){const p=M(s,["children","$$slots","$$events","$$legacy"]);re(g,oe({name:"chevron-right"},()=>p,{iconNode:[["path",{d:"m9 18 6-6-6-6"}]],children:(o,n)=>{var a=G(),c=D(a);H(c,s,"default",{}),x(o,a)},$$slots:{default:!0}}))}var qe=V('<img alt="Manga Page">'),De=V('<audio class="background-sound" loop><source type="audio/ogg"></audio>'),Ge=V('<div class="container svelte-1e9j59m"><div class="manga-container svelte-1e9j59m" role="presentation"><button class="nav-button svelte-1e9j59m"><!></button> <div class="manga-content svelte-1e9j59m"><!> <!></div> <button class="nav-button svelte-1e9j59m"><!></button></div></div>');function ot(g,s){ae(s,!0);const[p,v]=Ne(),o=()=>Ue(Se,"$manga",p);let n=A(q(parseInt(ee.params.chapterIndex))),a=A(q(parseInt(ee.params.pageIndex))),c={};const h=async({page:e,chapterIndex:i})=>{const f=`${i}-${e}`;return c[f]===void 0&&(c[f]=URL.createObjectURL(await Ie({chapterIndex:i,page:e}))),c[f]};let r={};const E=async e=>(r[e]===void 0&&(r[e]=URL.createObjectURL(await Re(e))),r[e]);let l={};const d=async e=>(l[e]===void 0&&(l[e]=URL.createObjectURL(await ze(e))),l[e]);let _=A(null),k=A(q([]));function u(e){m(),e instanceof KeyboardEvent&&(e.key==="ArrowLeft"?(e.preventDefault(),P()):e.key==="ArrowRight"&&(e.preventDefault(),L()))}function m(){document.querySelectorAll(".background-sound").forEach(i=>{i instanceof HTMLAudioElement&&i.play().then(()=>{}).catch(f=>{console.error("Background sound play failed:",f)})})}function P(){if(t(a)>0)$(a,t(a)-1);else if(t(n)>0){if(o()&&o().chapters[t(n)-1]){const e=o().chapters[t(n)-1].pages.length-1;$(n,t(n)-1),$(a,e)}}else alert("No more pages");te(`/chapter/${t(n)}/${t(a)}`,{})}function L(){o()&&o().chapters[t(n)]&&t(a)<o().chapters[t(n)].pages.length-1?$(a,t(a)+1):o()&&t(n)<o().chapters.length-1?($(a,0),$(n,t(n)+1)):alert("No more pages"),te(`/chapter/${t(n)}/${t(a)}`,{})}const I=async({page:e,bgm:i,se:f,voice:O})=>{$(_,await h({page:e,chapterIndex:t(n)}),!0);let y=[];i!==null&&(y=[...y,await E(i)]);for(const de of f)y=[...y,await d(de)];O&&(y=[...y,URL.createObjectURL(await je({chapterIndex:t(n),page:e}))]),$(k,y,!0),setTimeout(m,100)};ye(()=>{if(o()===null){alert("Manga not initialized");return}const e=o().chapters[t(n)];if(e===void 0){alert(`Chapter ${t(n)+1} not found`);return}const i=e.pages[t(a)];if(i===void 0){alert(`Page ${t(a)+1} not found`);return}I(i)}),Ae(()=>(document.addEventListener("click",u),document.addEventListener("keydown",u),()=>{document.removeEventListener("click",u),document.removeEventListener("keydown",u)}));var U=Ge(),R=w(U),S=w(R);S.__click=P;var z=w(S);Oe(z,{size:48}),C(S);var j=T(S,2);j.__click=u,j.__keydown=u;var J=w(j);{var ie=e=>{var i=qe();B(()=>Z(i,"src",t(_))),x(e,i)};Pe(J,e=>{t(_)!==null&&e(ie)})}var ce=T(J,2);se(ce,16,()=>t(k),e=>e,(e,i)=>{var f=De(),O=w(f);C(f),B(()=>Z(O,"src",i)),x(e,f)}),C(j);var W=T(j,2);W.__click=L;var le=w(W);Fe(le,{size:48}),C(W),C(R),C(U),x(g,U),ne(),v()}Ee(["click","keydown"]);export{ot as component};
